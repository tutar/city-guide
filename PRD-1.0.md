好的，我们将整个思路整理成一份结构化的产品需求文档。这份PRD旨在定义“City Guide智能助手”的首个核心模块——办事助手，并为其未来的扩展奠定基础。

---

## **City Guide智能助手产品需求文档**

**文档版本:** 1.0
**最后更新日期:** 2024年5月24日
**项目负责人:** tutar

### 1. 项目概述

**1.1 项目背景**
当前本地生活服务指南（如政府公众号）普遍存在信息滞后、解读不专业、交互僵化等问题，导致用户理解成本高、办事效率低。然而，其“全量导航”的形式为用户提供了宝贵的“启发式”探索价值。本项目旨在利用AI对话技术，打造一款全新的智能助手，首先解决“办事难”的痛点，并逐步构建一个覆盖本地生活全场景的智能指南。

**1.2 产品愿景**
成为最懂用户、最可靠的城市生活智能伙伴，通过自然、高效、准确的交互，让每一位市民都能轻松办理事务、发现资讯、享受生活。

### 2. 产品目标

**2.1 第一阶段：办事助手核心目标**
*   **提升信息准确性：** 与官方数据源对接，信息准确率 > 99%。
*   **降低用户理解成本：** 将复杂办事流程的用户完成率提升40%。
*   **保留导航完整性：** 通过创新交互，100%覆盖传统导航中的业务场景，确保用户不迷失。
*   **提升用户体验：** 用户满意度（CSAT）达到4.5/5.0以上。

**2.2 长期目标**
*   **平台化扩展：** 成功从办事场景扩展到“本地资讯”和“周末玩乐”场景。
*   **提升用户粘性：** 实现30%的周活跃用户率。

### 3. 核心功能需求 - 办事助手模块

**3.1 智能对话引导**
*   **描述：** 基于NLP引擎，支持用户通过自然语言进行多轮对话查询。
*   **需求点:**
    *   能够理解并处理模糊、口语化的提问。
    *   能够针对复杂流程进行多步骤、交互式引导。
    *   能够主动提问以澄清用户模糊需求。

**3.2 动态选项栏**
*   **描述：** 在聊天界面输入框上方，设计一个常驻的、可横向滑动的选项按钮区域。该区域的内容会根据对话上下文动态更新，是本次设计的核心创新点。
*   **需求点:**
    *   **初始状态：** 显示所有核心业务分类（如：港澳通行证、护照、收费标准...）。
    *   **上下文感知：** 当用户进入某一具体业务对话时，选项栏动态更新为该业务的子选项或关联操作（如：材料清单、在线预约、常见问题）。
    *   **全程导航：** 始终提供“返回主页”或“所有业务”按钮，确保用户随时可以回到全局导航。
    *   **UI/UX：** 设计需醒目且不遮挡主要聊天内容，支持滑动以展示更多选项。

**3.3 权威信息整合与解释**
*   **描述：** 确保所有信息的权威性与时效性，并对专业术语进行通俗化解读。
*   **需求点:**
    *   **官方数据源：** 优先对接政府官方API，或建立官方信息抓取与验证机制。
    *   **解释引擎：** 内置术语库和解释脚本，当用户提问或出现复杂概念时，能用通俗语言和举例进行说明。
    *   **来源标注：** 关键信息需明确标注来源与更新时间，建立信任。

**3.4 无缝衔接行动**
*   **描述：** 在对话流中无缝集成实际行动点，减少用户跳出。
*   **需求点:**
    *   能够直接生成官方预约网站的深度链接。
    *   能够一键调用地图，展示最近的办理网点。
    *   可集成文件上传功能（未来），方便用户预填材料。

### 4. 用户交互流程示例

**场景：用户首次进入，办理港澳通行证**

1.  **用户打开App。**
2.  **系统状态：**
    *   **AI问候：** “欢迎！我是您的深圳出入境AI助手，信息官方准确。您想了解什么？”
    *   **动态选项栏：** 显示 `[港澳通行证] [护照] [台湾通行证] [网点查询] [收费标准] [所有业务...]`
3.  **用户点击「港澳通行证」。**
4.  **系统状态：**
    *   **AI回复：** “好的，港澳通行证业务包括新办、续签、查询等。请问您需要办理哪一项？”
    *   **动态选项栏更新为：** `[新办指南] [续签指南] [进度查询] [材料清单] [返回主页]`
5.  **用户点击「新办指南」。**
6.  **系统状态：**
    *   **AI回复：** 分步介绍新办流程、所需材料，并重点提示照片规格。
    *   **动态选项栏更新为：** `[在线预约] [照片要求详解] [收费标准] [常见问题] [所有业务...]`
7.  **用户点击「在线预约」。**
8.  **系统状态：** 调用系统浏览器，直接打开官方的预约页面。

### 5. 未来扩展规划

**5.1 资讯模块**
*   **描述：** 提供本地新闻、政策变动、活动预告的个性化推送和查询。
*   **交互构想：** 用户可订阅兴趣标签（如“社保新政”、“本地展览”）。AI可主动推送“您关心的护照照片新规已于昨日发布”，并通过选项栏提供 `[查看详情] [对比旧规] [预约办理]` 等快捷操作。

**5.2 周末玩乐模块**
*   **描述：** 基于用户偏好和场景，推荐周末活动、餐厅、景点。
*   **交互构想：** 用户输入“周末带小孩去哪玩？”，AI通过问答（如预算、区域、兴趣）进行推荐，动态选项栏提供 `[按公园筛选] [按展览筛选] [生成一日行程] ` 等筛选和深度操作功能。

### 6. 非功能性需求和成功指标

**6.1 非功能性需求**
*   **性能：** 95%的AI响应时间 < 1秒。
*   **准确性：** 核心办事信息的准确率 > 99%。
*   **可扩展性：** 系统架构设计需支持未来轻松接入新的服务模块和数据源。
*   **可用性：** 界面简洁，核心功能在3次点击内可达。

**6.2 非功能性需求**
*   **核心指标：**
    *   任务完成率
    *   平均会话轮次
    *   用户满意度
    *   “动态选项栏”点击率
*   **辅助指标：**
    *   用户首次使用至成功办理的时长
    *   官方链接跳转率
    *   用户主动返回率


#### **7. 技术方案（新增章节）**

**7.1 核心架构概述**
City Guide智能助手将采用基于大语言模型的问答系统架构，核心流程为“检索-增强-生成”。该系统通过从权威数据源检索最新信息，将其作为上下文提供给LLM，从而生成准确、可靠的回答。

**7.2 核心技术栈**
*   **大语言模型：** 采用 **DeepSeek LLM API** 作为核心推理引擎，负责理解用户意图、组织信息并生成自然语言回复。
*   **知识库与检索系统：**
    *   **数据源：** 以 **深圳政府官方网站** 作为首要和权威数据来源，确保信息的准确性；以 **深圳本地宝** 作为辅助信息来源，用于补充官方信息中可能缺失的解读性、整合性内容。
    *   **检索技术：** 实施 **混合检索** 策略：
        *   **密度检索：** 使用Embedding模型将查询和文档段落转换为高维向量，通过语义相似度匹配来查找相关信息。擅长处理“意思相近但用词不同”的查询。
        *   **稀疏检索：** 使用如BM25等传统检索算法，基于关键词匹配进行查找。擅长处理包含特定专有名词（如“港澳通行证L签”）的精确查询。
    *   **融合排序：** 将两种检索方式的结果进行融合与重新排序，确保返回最相关、最全面的文档片段。

**7.3 数据处理流程**
1.  **数据抓取与清洗：** 建立自动化爬虫系统，定期从官网和本地宝抓取数据，并进行清洗、去重和格式化。
2.  **文档切分与向量化：** 将清洗后的长文档按主题或段落进行智能切分，并通过Embedding模型将其转换为向量，存入向量数据库。
3.  **用户查询处理：** 当用户发起查询时，系统同时进行密度检索和稀疏检索。
4.  **上下文增强生成：** 将检索到的最相关的文档片段作为“上下文”，与用户的原始“问题”一同构成Prompt，发送给DeepSeek LLM API，指令其基于此上下文生成回答。

---

#### **8. 风险与依赖（更新后）**

**8.1 技术依赖**
*   **依赖1：DeepSeek LLM API的服务质量与稳定性。**
    *   **风险：** API服务的响应延迟、频次限制或意外中断将直接影响产品核心功能。
    *   **缓解措施：**
        *   实施请求重试机制和合理的速率限制。
        *   在客户端设计友好的加载和降级状态（如“助手正在思考，请稍候”）。
        *   （长期）考虑对关键业务逻辑进行Prompt的A/B测试，并评估多模型备选方案。
*   **依赖2：外部数据源的结构稳定性和可访问性。**
    *   **风险：** 政府官网或本地宝的网站结构改版将导致数据抓取脚本失效，造成信息更新延迟。
    *   **缓解措施：**
        *   建立**网站监控与变更警报系统**，一旦抓取失败或内容结构发生重大变化，立即通知技术团队。
        *   编写**高鲁棒性的解析脚本**，并定期维护。
        *   对于官网，**积极寻求与政府部门合作，获取官方API接口**，这是根治此风险的长期目标。

**8.2 数据与内容风险**
*   **风险1：信息冲突与权威性甄别。**
    *   **风险：** 当政府官网信息与本地宝的解读信息存在冲突时，可能导致AI生成错误或混淆的内容。
    *   **缓解措施：**
        *   在检索系统中设置**优先级权重**，官方来源的文档在排序中享有更高权重。
        *   在Prompt设计中加入**强指令**，例如：“请优先并主要依据来自[深圳公安局官网]的上下文信息进行回答，来自[深圳本地宝]的信息仅作为流程理解的辅助参考。”
        *   在AI回答的末尾，固定标注：“请以官方最终发布的信息为准。”
*   **风险2：混合检索的准确率瓶颈。**
    *   **风险：** 检索系统可能未能召回关键信息，或召回了无关信息，导致LLM“幻觉”或回答不完整。
    *   **缓解措施：**
        *   建立**检索效果的评估体系**，持续优化Embedding模型、切分策略和融合排序算法。
        *   引入**用户反馈循环**，当用户对回答点“踩”时，自动记录当时的查询和检索结果，用于后续分析优化。

**8.3 实施计划与里程碑**

**Phase 1: MVP (最小可行产品) - 办事助手核心**
*   **目标：** 验证“检索-增强-生成”流程在出入境业务上的可行性。
*   **范围：** 聚焦“港澳通行证”、“护照”2-3个核心业务。
*   **数据：** 完成上述业务相关官网和本地宝页面的抓取、清洗与向量化。
*   **功能：** 实现基础对话流程与动态选项栏UI。

**Phase 2: 扩展与优化**
*   **目标：** 扩大业务覆盖范围，提升系统准确性与稳定性。
*   **范围：** 覆盖PRD中定义的出入境所有业务。
*   **技术：** 建立完整的监控报警系统；基于用户反馈优化检索效果。

**Phase 3: 平台化演进**
*   **目标：** 验证技术架构对其他场景（资讯、玩乐）的支撑能力。
*   **范围：** 增加一个非办事类场景（如“周末游玩”）作为试点。
*   **架构：** 评估并实施面向多场景的知识库管理与路由机制。

---
**修订记录更新**
*   **V1.1:** 新增“技术方案”章节；大幅更新“风险与依赖”章节，补充了具体的技术路径、风险缓解措施和分阶段实施计划。
**文档修订记录**
*   V1.0: 创建初版PRD，明确办事助手核心形态与未来扩展路径。
